<view class="container">
  <view class="tabs">
    <view 
      class="tab-item {{currentTab === 0 ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="0"
    >
      <text>待处理</text>
    </view>
    <view 
      class="tab-item {{currentTab === 1 ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="1"
    >
      <text>进行中</text>
    </view>
    <view 
      class="tab-item {{currentTab === 2 ? 'active' : ''}}" 
      bindtap="switchTab" 
      data-tab="2"
    >
      <text>已完成</text>
    </view>
  </view>

  <scroll-view scroll-y class="order-list" bindscrolltolower="loadMore">
    <view class="empty-state" wx:if="{{orders.length === 0}}">
      <image class="empty-icon" src="/images/empty-order.png"></image>
      <text class="empty-text">暂无订单</text>
    </view>

    <view class="order-item" wx:for="{{orders}}" wx:key="_id" bindtap="goToDetail" data-id="{{item._id}}">
      <view class="order-header">
        <text class="order-no">订单号：{{item.orderNo}}</text>
        <text class="order-status">{{item.statusText}}</text>
      </view>
      <view class="order-info">
        <text class="table-number">桌号：{{item.tableNumber}}</text>
        <text class="order-time">{{item.timeText}}</text>
      </view>
      <view class="order-items">
        <view class="item-preview" wx:for="{{item.items}}" wx:for-item="dish" wx:key="dishId">
          <image class="dish-image" src="{{dish.image}}" mode="aspectFill"></image>
          <text class="dish-name">{{dish.name}}</text>
          <text class="dish-quantity">x{{dish.quantity}}</text>
        </view>
      </view>
      <view class="order-footer">
        <text class="total-price">合计：¥{{item.totalPrice}}</text>
        <view class="action-btns">
          <button 
            class="action-btn pay-btn" 
            wx:if="{{item.status === 0}}" 
            catchtap="payOrder" 
            data-id="{{item._id}}"
          >
            去支付
          </button>
          <button 
            class="action-btn cancel-btn" 
            wx:if="{{item.status === 0}}" 
            catchtap="cancelOrder" 
            data-id="{{item._id}}"
          >
            取消订单
          </button>
          <button 
            class="action-btn reorder-btn" 
            wx:if="{{item.status === 2}}" 
            catchtap="reorder" 
            data-id="{{item._id}}"
          >
            再来一单
          </button>
        </view>
      </view>
    </view>
  </scroll-view>
</view>