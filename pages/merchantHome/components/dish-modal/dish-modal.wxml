<view class="modal-mask" wx:if="{{show}}" bindtap="onClose"></view>
<view class="modal-container" wx:if="{{show}}">
  <view class="modal-header">
    <text class="modal-title">{{isEdit ? '编辑菜品' : '添加菜品'}}</text>
    <text class="modal-close" bindtap="onClose">×</text>
  </view>
  <scroll-view class="modal-content" scroll-y>
    <view class="form-item">
      <text class="form-label required">菜品名称</text>
      <input class="form-input" placeholder="请输入菜品名称" value="{{formData.name}}" data-field="name" bindinput="onInput" />
    </view>
    <view class="form-item">
      <text class="form-label required">菜品价格</text>
      <input class="form-input" type="digit" placeholder="请输入价格" value="{{formData.price}}" data-field="price" bindinput="onInput" />
    </view>
    <view class="form-item">
      <text class="form-label">所属分类</text>
      <picker mode="selector" range="{{categories}}" range-key="name" value="{{categoryIndex}}" bindchange="onCategoryChange">
        <view class="form-picker">
          <text>{{categories[categoryIndex].name || '请选择分类'}}</text>
          <text class="picker-arrow">›</text>
        </view>
      </picker>
    </view>
    <view class="form-item">
      <text class="form-label">菜品描述</text>
      <textarea class="form-textarea" placeholder="请输入菜品描述" value="{{formData.description}}" data-field="description" bindinput="onInput" maxlength="200" />
    </view>
    <view class="form-item">
      <text class="form-label">菜品图片</text>
      <view class="image-upload" bindtap="onChooseImage">
        <image wx:if="{{formData.image}}" src="{{formData.image}}" mode="aspectFill" class="preview-image"></image>
        <view wx:else class="upload-placeholder">
          <text class="upload-icon">+</text>
          <text class="upload-text">上传图片</text>
        </view>
      </view>
    </view>
    <view class="form-item">
      <text class="form-label">辣度</text>
      <picker mode="selector" range="{{spicyOptions}}" value="{{formData.spicyLevel}}" bindchange="onSpicyChange">
        <view class="form-picker">
          <text>{{spicyOptions[formData.spicyLevel]}}</text>
          <text class="picker-arrow">›</text>
        </view>
      </picker>
    </view>
    <view class="form-item">
      <text class="form-label">排序 (数字越小越靠前)</text>
      <input class="form-input" type="number" placeholder="0" value="{{formData.sort}}" data-field="sort" bindinput="onInput" />
    </view>
    <view class="form-item form-switches">
      <view class="switch-item">
        <text class="switch-label">热销推荐</text>
        <switch checked="{{formData.isHot}}" color="#FF6B6B" data-field="isHot" bindchange="onSwitch" />
      </view>
      <view class="switch-item">
        <text class="switch-label">新品推荐</text>
        <switch checked="{{formData.isNew}}" color="#FF6B6B" data-field="isNew" bindchange="onSwitch" />
      </view>
    </view>
  </scroll-view>
  <view class="modal-footer">
    <button class="modal-btn cancel" bindtap="onClose">取消</button>
    <button class="modal-btn confirm" bindtap="onSubmit">确定</button>
  </view>
</view>