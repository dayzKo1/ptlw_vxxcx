<view class="container">
  <view class="cart-section">
    <view class="section-header">
      <text class="section-title">è´­ç‰©è½¦</text>
      <text class="clear-btn" bindtap="clearCart">æ¸…ç©º</text>
    </view>
    <scroll-view scroll-y class="cart-list">
      <view class="cart-item" wx:for="{{cartItems}}" wx:key="_id">
        <view class="dish-image-placeholder">{{item.emoji || 'ğŸ½ï¸'}}</view>
        <view class="dish-info">
          <text class="dish-name">{{item.name}}</text>
          <text class="dish-price">Â¥{{item.price}}</text>
        </view>
        <view class="quantity-control">
          <view class="minus-btn" bindtap="minusDish" data-id="{{item._id}}">-</view>
          <text class="quantity">{{item.quantity}}</text>
          <view class="plus-btn" bindtap="plusDish" data-id="{{item._id}}">+</view>
        </view>
      </view>
      <view class="empty-cart" wx:if="{{cartItems.length === 0}}">
        <text class="empty-icon">ğŸ›’</text>
        <text class="empty-text">è´­ç‰©è½¦æ˜¯ç©ºçš„</text>
      </view>
    </scroll-view>
  </view>

  <view class="delivery-mode-section">
    <text class="section-label">é…é€æ–¹å¼</text>
    <view class="delivery-mode-options">
      <view 
        class="delivery-mode-option {{deliveryMode === 'dineIn' ? 'active' : ''}}" 
        bindtap="switchDeliveryMode" 
        data-mode="dineIn"
      >
        <text class="delivery-mode-icon">ğŸ½ï¸</text>
        <text class="delivery-mode-text">å ‚é£Ÿ</text>
      </view>
      <view 
        class="delivery-mode-option {{deliveryMode === 'takeaway' ? 'active' : ''}}" 
        bindtap="switchDeliveryMode" 
        data-mode="takeaway"
      >
        <text class="delivery-mode-icon">ğŸ›µ</text>
        <text class="delivery-mode-text">å¤–å–</text>
      </view>
    </view>
  </view>

  <view class="address-section" wx:if="{{deliveryMode === 'takeaway'}}">
    <view class="address-header">
      <text class="address-title">é…é€åœ°å€</text>
      <text class="add-address-btn" bindtap="goToAddressList">+ é€‰æ‹©åœ°å€</text>
    </view>
    <scroll-view scroll-x class="address-list" wx:if="{{addresses.length > 0}}">
      <view 
        class="address-item {{addressId === item._id ? 'active' : ''}}" 
        wx:for="{{addresses}}" 
        wx:key="_id"
        bindtap="selectAddress"
        data-id="{{item._id}}"
      >
        <view class="address-info">
          <text class="address-name">{{item.name}} {{item.phone}}</text>
          <text class="address-detail">{{item.province}}{{item.city}}{{item.district}}{{item.detail}}</text>
        </view>
        <text class="address-check" wx:if="{{addressId === item._id}}">âœ“</text>
      </view>
    </scroll-view>
    <view class="empty-address" wx:if="{{addresses.length === 0}}">
      <text>æš‚æ— åœ°å€ï¼Œè¯·æ·»åŠ </text>
    </view>
  </view>

  <view class="remark-section">
    <text class="section-label">è®¢å•å¤‡æ³¨</text>
    <textarea 
      class="remark-input" 
      placeholder="è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯ï¼Œå¦‚ï¼šå°‘è¾£ã€ä¸è¦é¦™èœç­‰" 
      value="{{remark}}"
      bindinput="onRemarkInput"
      maxlength="100"
    ></textarea>
  </view>

  <view class="total-section">
    <view class="total-row">
      <text class="total-label">å•†å“é‡‘é¢</text>
      <text class="total-value">Â¥{{goodsTotal}}</text>
    </view>
    <view class="total-row" wx:if="{{deliveryMode === 'takeaway'}}">
      <text class="total-label">é…é€è´¹</text>
      <text class="total-value">Â¥{{deliveryFee}}</text>
    </view>
    <view class="total-row total-row-main">
      <text class="total-label">åˆè®¡</text>
      <text class="total-price">Â¥{{totalPrice}}</text>
    </view>
  </view>

  <view class="footer-section">
    <button class="submit-btn" bindtap="submitOrder">æäº¤è®¢å•</button>
  </view>
</view>
