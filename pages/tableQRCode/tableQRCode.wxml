<view class="container">
  <view class="header">
    <text class="title">桌号二维码管理</text>
    <text class="subtitle">生成并下载桌号二维码，打印后贴到桌上</text>
  </view>

  <view class="actions">
    <button class="btn-primary" bindtap="batchGenerate" disabled="{{generating}}">
      <text wx:if="{{!generating}}">批量生成所有二维码</text>
      <text wx:else>生成中...</text>
    </button>
  </view>

  <view class="table-list">
    <view class="table-item" wx:for="{{tables}}" wx:key="_id">
      <view class="table-info">
        <text class="table-number">{{item.tableNumber}}</text>
        <text class="table-status" wx:if="{{item.qrCode}}">已生成</text>
        <text class="table-status pending" wx:else>未生成</text>
      </view>

      <view class="qr-code-area" wx:if="{{item.qrCode}}">
        <image 
          class="qr-code" 
          src="{{item.qrCode}}" 
          mode="aspectFit"
          bindtap="previewImage"
          data-url="{{item.qrCode}}"
        ></image>
      </view>

      <view class="table-actions">
        <button 
          class="btn-secondary" 
          size="mini"
          bindtap="generateQRCode"
          data-table-number="{{item.tableNumber}}"
        >
          生成二维码
        </button>
        <button 
          class="btn-secondary" 
          size="mini"
          wx:if="{{item.qrCode}}"
          bindtap="downloadImage"
          data-url="{{item.qrCode}}"
          data-table-number="{{item.tableNumber}}"
        >
          下载图片
        </button>
      </view>
    </view>

    <view class="empty" wx:if="{{tables.length === 0 && !loading}}">
      <text>暂无桌号数据</text>
    </view>
  </view>
</view>
